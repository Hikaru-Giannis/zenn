---
title: "PHPとIEEE754: 浮動小数点数を理解しSQLServerの問題を解決する"
emoji: "⛳"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["php"]
published: false
---
## 序章
ある日のこと、私はSQLServerにて特定のデータを扱うべく、整数部が最大15桁、少数部が最大10桁までを要件とするDecimal(25,10)型のカラムに、具体的には「999999999999999.1234567891」という値をインサートしようと試みました。その結果、予期しない問題に遭遇しました。

````txt
PDOException: SQLSTATE[42000]: [Microsoft][ODBC Driver 18 for SQL Server][SQL Server]データ型 nvarchar を numeric に変換中にエラーが発生しました。
````

このエラーメッセージによれば、nvarchar型をnumeric型に変換する際に問題が発生したようです。初めて見るエラーに対し、私はまずカラムの型定義を誤っているのではないかと思いました。しかし、詳しくログを調べてみると、問題の原因は実は異なるところにあることがわかりました。

原因は該当の数値がPHP側で`1.0E+15`という形になる、すなわち科学的記数法（指数表記）となっていました。この事象は、PHPがデフォルト設定で採用している浮動小数点数の表現形式、IEEE754が関与していると考えられました。

そこでこの記事では、この問題を解決するために必要な、IEEE754の理解に焦点を当てて解説を行います。

## 浮動小数点数の基本
### 浮動小数点数の基本的な概念の説明
### 浮動小数点数が科学的数字になるメカニズム

## IEEE754の基本
### IEEE754の仕様の紹介
### IEEE754での浮動小数点数の表現方法とその特性

## Decimal型
### Decimal型の基本的な特性と動作原理
### Decimal型で科学的数字が代入できない理由

## 問題解決のための解法
### PHPでの数値の形式変換方法
### その他の解決策や注意点

## まとめ
### IEEE754と浮動小数点数の理解の重要性
### その理解がどのように具体的な問題解決につながったか

